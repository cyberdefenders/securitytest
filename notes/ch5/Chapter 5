**5.1 Security Appliances**

| Term                           | Definition                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|--------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Security zone                  | Portions of the network or system that have specific security concerns or requirements. All devices with the same zone have the same security access and security protection needs Zones are often separated by a traffic control device, such as a firewall or a router, which filters incoming and outbound traffic. For example, you can define a zone that includes all hosts on your private network protected from the internet.  Can also define a zone within your network for controlled access to specific servers that hold sensitive information. |
| Wireless network               | A network that does not require a physical connection.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| Guest network                  | A network that grants internet access only to guest users. A guest network has a firewall to regulate guest user access.                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| Honeynet                       | A special zone or network created to trap potential attackers.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| Ad hoc                         | A decentralized network that allows connections without a traditional base station or router. It allows users to connect two or more devices directly to each other for a specific purpose.                                                                                                                                                                                                                                                                                                                                                                   |
| Intranet zone                  | A private network that employs internet information services for internal use only.                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| Internet                       | A public network that includes all publicly available web servers, FTP servers, and other services.                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| Extranet                       | A privately-controlled network distinct from but located between the internet and a private LAN.                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| Demilitarized zone             | A network that contains publicly accessible resources and is located between the private network and an untrusted network, such as the internet. It is protected by a firewall.                                                                                                                                                                                                                                                                                                                                                                               |
| Proxy server                   | A type of firewall that stands as an intermediary between clients requesting resources from other servers. Middleman which can restrict traffic based on rules. Blacklists and whitelists enabled for sites and protocols, can be individual or group based.   Can anonymize users and offer periodic web caching to speed up browsing.  Can be used offensively to intercept and steal information, installed through malware links in email. Block unauthorized proxy servers if you value your job.                                                        |
| Internet content filter        | Software used to monitor and restrict content delivered across the web to an end user. Configured to block websites based on categories, updated via subscription.                                                                                                                                                                                                                                                                                                                                                                                            |
| Network access  control        | Software that controls access to the network by not allowing computers to access network resources unless they meet certain predefined security requirements. (Where are your papers?) Simplest form is 802.1x, authentication protocol for port-based security.                                                                                                                                                                                                                                                                                              |
| All-in-one  security appliance | An appliance that combines many security functions into a single device. UTM is usually a singular device managed by a web portal, with subscription updates. Good for budgets, remote offices.  Functions include: URL filtering Content inspection Spa filtering Rule based and log enabled firewalls Integrated IDS/IPS  Can be integrated as an al-in-one device with an integrated switch/router enabling connection with an uplink port. Ideal for small businesses. These can also do traffic shaping/prioritization.                                  |
| Application-aware devices      | A device that has the ability to analyze and manage network traffic based on the application-layer protocol.                                                                                                                                                                                                                                                                                                                                                                                                                                                  |

**Security Zone Networks**

| Network Type | Description                                                                                                                                                                                                                                                                      |
|--------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Wireless     | used on most internal networks so that internal users do not require a physical connection to a router or switch.                                                                                                                                                                |
| Guest        | grants internet access only for guest users also has some type of firewall to regulate that access. There could be limited internal resources made available on a guest network. Blocks access to intranet and internal network.                                                 |
| Honeynet     | created to trap potential attackers. Honeynets have vulnerabilities that lure attacks so that you can track their actions and protect your real network.                                                                                                                         |
| Ad hoc       | decentralized network that allows connections without a traditional base station or router. It allows users to connect two or more devices directly to each other for a specific purpose. Must have compatible and matching parameters and protocols(SSID, security, encryption) |

**Common Security Zones**

| Zone                             | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|----------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Intranet                         | **Private network (LAN)** that employs internet information services for internal use only. I.E. web servers and email servers that are used by company employees. Can also mean an internal wiki/webpage.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| Internet                         | Public network that includes all publicly available web servers, FTP servers, and other services.  Access is largely open to everyone.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| Extranet                         | Privately controlled network distinct from the intranet Located between the internet and a private LAN.  Used to grant resource access to business partners, suppliers, customers outside of the organization.  VPN or WAN access.  Limits access to services and resources.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| Wireless                         | Broadcasted network connection used within an organization.  Users use a wireless connection on their device to connect to a wireless access point.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| Demilitarized zone               | Part of a layered security approach.  Contains publicly accessible resources.  Located between the private network and an untrusted network (such as the internet), protected by firewalls. Allows external access to email, VPN, and internal web servers.  Firewall allows traffic from internet into DMZ, enabling access of resources on production network.  A bastion host is a hardened server that is exposed to attacks by untrusted networks. It can be placed inside the DMZ or exposed on the public network. They usually only host a single service.  If the firewall managing traffic into the DMZ fails, only the servers in the DMZ are subject to compromise. LAN protected by default. Packet filters on the firewall allow traffic directed to the public resources inside the DMZ. Prevents unauthorized traffic from reaching the private network. When designing the firewall packet filters, close all ports, then open only those ports necessary for accessing the public resources inside the DMZ. To allow access to private resources from the internet: Place a VPN server inside the DMZ. Require internet users to authenticate to the VPN server and then allow communications from the VPN server to the private network. Only communications coming through the VPN server are allowed through the inner firewall. Copy resources that are accessible to internet users to servers inside the DMZ. Even with authentication and authorization configured, this approach exposes those resources in the DMZ to internet attacks. Firewalls allow traffic **originating in the secured internal network into the DMZ and through to the internet**. **Traffic that originates in the DMZ (low-security area) or the internet (no-security area) should not be allowed access to the intranet (high-security area).** Only places servers in the DMZ that are needed.  |
| Bastion or sacrificial host      | Any host that is exposed to attack and that has been hardened (or fortified) against those attacks.   • A host that is exposed on the network and is not protected by a firewall device. • The device that provides the firewall service to the screened network behind it. Attacks must pass through the bastion host before they are allowed inside the screened subnet. • A honeypot device that is purposefully exposed to attack in order to distract attackers.  **To harden a bastion host:**  • Separate roles of bastion hosts by placing a single application on each server. • Fully patch your bastion host on the operating system and on applications. • Run current versions of antivirus and anti-spyware software. • Include a personal firewall. • Uninstall any unnecessary applications or utilities. • Disable and lock down all unnecessary services and ports. • Tighten security on the registry and the user database. • Add IP filters. Run lockdown facilities, such as IIS lock down and URLScan.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| Network Address Translation(NAT) | Provides global IP address conversion for the entire network and is usually performed by your internet gateway/ NAT server.  Translates these internal private IP address to public IP addresses from their ISP and vice versa.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |

**5.1.5 Security Solution Facts**

| Device                         | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|--------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Proxy server                   | Type of firewall that stands as an intermediary between clients requesting resources from other servers **Application-level gateway; performs filtering at the Application layer.**  Restrict users on the inside of a network from getting out to the internet. Restrict access by user or by specific website. Restrict users from using certain protocols. Use access controls to control inbound or outbound traffic. Shield or hide a private network to provide online anonymity and make it more difficult to track web surfing behavior. Cache heavily accessed web content to improve performance. Proxy servers can also be a security risk and can be used to circumvent network security and even attack a network.                                                                                                           |
| Internet content filter        | Used to monitor and restrict content delivered across the web to an end user.  Either Allow all content except for explicated restricted. Or Block all content except for explicitly permitted. Allowed or blocked content is identified by the following:  Whitelists identify allowed sites or content. Blacklists identify disallowed or blocked content. Category levels use classification to block content based on content type. Common methods for restricting content include:  Category(including applications) URLs DNS Most also block pop-ups and filter spam. Keyword filtering can be configured to block the results of searches                                                                                                                                                                                          |
| Network Access Control (NAC)   | Controls access to the network by disallowing computers to access network resources unless they meet certain predefined security requirements.  Attempts to unify endpoint security by defining standardized security measures  Requires a NAC agent (software to monitor the health of a machine) to be installed on each computer as price of admission. A client determined healthy by the NAC agent is given access to the network. An unhealthy client (one that has not met all the checklist requirements) is either denied access or can be given restricted access to a remediation network. After this, remediation servers can help the client become compliant. **Used with 802.1x as an authentication protocol for port-based security**.  Microsoft's version of the NAC security tool is Network Access Protection (NAP). |
| All-in-one security appliances | **AKA unified threat security devices** or **web security gateways***.* This type of device may be the best choice for:  Low budget No space No technician Security functions in an all-in-one security appliance can include: Spam filters URL filters Web content filters Malware inspection Intrusion detection systems In addition to security functions, all-in-one security appliances can include: Network switches Routers Firewalls Tx uplink (integrated CSU/DSU) Bandwidth shaping                                                                                                                                                                                                                                                                                                                                             |
| Application-aware devices      | Analyze and manage network traffic based on the Application layer protocol that created it.  Can also apply quality of service (QoS) and traffic-shaping rules based on the application that created network traffic.  Application-aware firewalls enforce security rules based on the application that is generating network traffic  Application-aware IDS or IPS analyze network packets to detect malicious payloads targeted at Application layer services (such as a web server). Application-aware proxies manage traffic based on the Application layer protocols they support, such as FTP or HTTP.  Prevent the application client from performing undesirable actions, such as stopping FTP uploads.  Improve application performance via caching/                                                                             |
| Screening router               | Most external to your network and closest to the internet. It uses access control lists (ACLs) to filter packets as a form of security. A firewall performing router functions is considered a screening router.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| Dual-homed gateway             | firewall device that typically has three network interfaces: **one connected to the internet, one connected to the public subnet, and one connected to the private network**. Gateways have to be logged on to, whereas routers pass traffic through without user authentication. IP forwarding is disabled on gateways, effectively blocking through traffic to the network.                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| Screened-host gateway          | resides within the DMZ, requiring users to authenticate in order to access resources within the DMZ or the intranet.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| Screened subnet                | uses two firewalls. **The external firewall is connected to the internet and allows access to public resources. The internal firewall connects the screened subnet to the private network**. With a screened subnet, if the outer firewall is compromised, the inner firewall still protects the private network.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |

**5.3 Firewalls**

| Term                                     | Definition                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Firewall                                 | A device, or software running on a device, that inspects network traffic and allows or blocks traffic based on a set of rules.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| Application firewall/host-based firewall | installed on a workstation and used to protect a single device. An **application firewall is also known as a host-based firewall.** inspects traffic received by a host.  Useful for when there is no network firewall(public wifi) software programs which can be configured to meet the security requirements of the specific host and add an additional layer of security even when a network firewall has been implemented. An Application layer firewall (also referred to as **an Application level gateway or proxy**) **makes security decisions based on packet’s data**. Operates up to OSI Layer 7 (the Application layer) Stops each packet at the firewall and inspects it: **no IP forwarding** Inspects encrypted packets, such as in SSL inspection Examines the entire content (not just individual packets) Understands or interfaces with the Application layer protocol Can filter based on user, group, and data such as URLs within an HTTP request Is the slowest form of firewall because entire messages are reassembled at the Application layer A **proxy server** is a device that stands as an intermediary between a secure private network and the public and is a specific implementation of an Application level firewall. Every packet is stopped and inspected at the firewall, which causes a break between the client and the source server.  Control both inbound and outbound traffic Increase performance by caching heavily accessed content (content is retrieved from the proxy cache instead of the original server) Filter content Shield or hide a private network Restrict access by user or by specific websites Allows inspection of encrypted packets, such as SSL inspection |
| Network firewall                         | A firewall that is used to regulate traffic in and out of an entire network. A network-based firewall inspects traffic as it flows between networks.  install a network-based firewall on the edge of your private network that connects to the internet to protect against attacks from internet hosts.  typically dedicated hardware devices.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| Stateless firewall/Packet Filtering      | Allows or denies traffic by examining information in IP packet headers without considering whether the packet is part of a valid and active session..   Use ACL(access control lists) to check packets based on criteria such as IP addresses, port numbers, services and direction.  Implicit deny rule: blocked unless allowed otherwise. Static decisions. Operates up to OSI Layer 3 (the Network layer) Uses access control lists (ACLs) or filter rules to control traffic Offers high performance because it only examines addressing information in the packet header Can be implemented using features that are included in most routers Subject to DoS and buffer overflow attacks Easy to implement, maintain, minimal impact on performance, inexpensive                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| Stateful firewall                        | A firewall that allows or denies traffic based on virtual circuits of sessions. A stateful firewall is also known as a circuit-level proxy or circuit-level gateway. Tracks and maintains session data in a session or state database. Stores more data for analysis and enforcement of encryption protocols. Resource intensive. Dynamic decisions.  The stateful inspection firewall (also known as circuit-level proxy or gateway) makes decisions about which traffic to allow based on virtual circuits or sessions. The firewall is considered stateful because it keeps track of the state of a session. A stateful inspection firewall:  Operates up to OSI Layer 5 (the Session layer) Keeps track of known connections and sessions in a session ta*ble* (also referred to as a state table) Allows only valid packets within approved sessions Verifies that packets are properly sequenced Ensures that the TCP three-way handshake process occurs only when appropriate Can filter traffic that uses dynamic ports because the firewall matches the session information (not the port numbers) for filtering Slower than packet filtering firewalls, unless only the session state is being used for filtering, then can be faster after the initial session table has been created.                                                                                                                                                                                                                                                                                                                                                                                                                               |
| Firewall Management Practices            | When designing firewall packet filters, a common practice is to close all ports. Open only those ports necessary for accessing the resources behind the firewall. If a host cannot communicate on the network, or if specific types of traffic (such as ICMP or Remote Desktop connection) don't work on a host, check the host firewall settings to make sure that the traffic type is allowed. Firewalls typically create log entries when packets are blocked by firewall rules. You can examine these logs to help troubleshoot communication problems or identify potential attacks (such as DoS attacks).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |

**Firewall Security Features**

| Feature                | Characteristics                                                                                                                                                                                                                           |
|------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Block ping to WAN      | This feature helps prevent attackers from discovering your network through ICMP Echo (ping) requests.                                                                                                                                     |
| Stealth Mode           | This feature prevents the response to port scans from the WAN. This protects against port floods.                                                                                                                                         |
| TCP Flood              | This feature drops all invalid TCP packets. This protects your network from SYN flood attacks.                                                                                                                                            |
| UDP Flood              | This feature helps prevent UDP flood attacks by metering the number of simultaneous, active UDP connections from a single computer on the internal network.                                                                               |
| ICMP Notification      | This feature can silently block the sending of ICMP notifications. Some protocols may require these notifications.                                                                                                                        |
| Fragmented Packets     | This feature blocks the sending of fragmented IP packets.                                                                                                                                                                                 |
| SYN Flood Detect Rate  | To help prevent SYN floods, this feature monitors the rate of SYN packets during a configuration time period. Too many SYN packets cause the firewall to determine that a SYN flood is occurring and to trigger the appropriate response. |
| Echo Storm Detect Rate | To help prevent ping floods, this feature monitors the rate of echo pings during a configuration time period. Too many pings cause the firewall to determine that a ping flood is occurring and to trigger the appropriate response.      |
| ICMP Flood Detect Rate | This feature monitors non-ping ICMP packets. Too many cause the firewall to determine that a ICMP flood is occurring and trigger the appropriate response.                                                                                |

**5.4 Network Address Translation**

| Term                                | Definition                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|-------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| **Network Address Translation**     | A method used by routers to translate multiple, unregistered private IP addresses into a single/limited number of registered IPv4 address (es).  Implemented on a default gateway router with 2+ network interfaces, 1 for private and 1 for public, provided for cost by ISP. **Layer 3 protocol** NAT router strips private IP at header and replaces with Public IP and vice versa. This may impair IPSec Superficial obscuration of private network  Traffic may flow in both directions, **max 5000 concurrent connections** Not a firewall, does not provide improved traffic throughput like a proxy server Limited capacity as DHCP server: names to private hosts Forwards DNS to internet Because NAT changes packet headers, IPSec might not work correctly through NAT. IPSec detects changes to packet headers as part of the security process |
| **Non-routable private addresses**  | **\* Class-A**: 10.0.0.0 through 10.255.255.255  **\* Class-B**: 172.16.0.0 through 172.31.255.255  **\* Class-C**: 192.168.0.0 through 192.168.255.255                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| **Internal network**                | Private network, devices use private IP addresses to communicate with each other.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| **Internal address**                | The private IP address that is translated to an external IP address by NAT.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| **External network**                | The public network that a NAT device connects to with a single public IP address.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| **External address**                | The public IP address that NAT uses to communicate with the external network.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| **Port Address Translation  (PAT)** | An extension of NAT that associates a port number with a request from a private host. When a request is sent, the NAT router sends it from a randomly selected dynamic port on its public IP address.  Port range 49,152 to 65,535 used as dynamic ports. The NAT router picks one of these dynamic ports and forwards the request out on the public network from the selected port.  The NAT router maps the IP address of the originating host to a particular dynamic port and stores it in the translation table                                                                                                                                                                                                                                                                                                                                        |
| **Modes of NAT**                    | **Many to one/ IP masquerade**: Many different private host are represented by one registered IP address.  One-way implementation. Data can come from the internal private network and be sent to the public network Prevents direct connecting from the internet to a private network web server due to a many-to-one relationship between the registered IP address and the various hosts on the private network. Ports are dynamic.  **Static/ one to one NAT**: allows you to manually configure a permanent one-to-one mapping in the translation table. -Also known as port forwarding.                                                                                                                                                                                                                                                               |
| **IPV6 local address range**        | IPv6 reserves all addresses beginning with a binary 1111 1110 11 (hexadecimal FEC0::/48) for private IP networks.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |

**Section 5.5 Virtual Private Networks**

| Term                              | Definition                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|-----------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| **Virtual private network (VPN)** | uses encryption to send data securely over an untrusted network Provides an alternative to WAN connections and connections that use telephone lines and a remote access server  uses a protocol that tunnels, or encapsulates, each of those packets into a new encrypted packet                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| **Modes of VPN**                  | Host-to-Host VPN: Allows an individual host connected to the internet to establish a VPN connection to another host. Both devices need the ability to establish and understand the VPN protocol that's used. Both devices must have the software for encrypting the packets and encapsulating the packets  • Site-to-Site VPN: Done with a collection of computers at each location. Each computer is able to communicate securely with any other computer at another location. VPN configuration done on gateway server, not individual devices; Routers on the edge of each site. • Remote Access VPN: Hosts on the network can establish a VPN connection to the remote site. Client must be able to establish the VPN connection with a special device called a VPN concentrator that sits on the edge of the private network.                                                                                                                                                                                                                                                                                |
| **VPN Tunneling Protocols:**      | • **IPSec**: Actually made up of 2 protocols:  **Authentication Header (AH):** provides authentication, integrity, and replay protection (but not confidentiality), also secures parts of the IP header of the packet **Encapsulating Security Payload (ESP):** used to encrypt data/give confidentiality used with or without authentication/integrity, provide replay protection if supplied with authentication and integrity. Authentication/integrity also possible with or without confidentiality. 2 different modes:  **Transport mode:** which only encrypts each packet's internal data. AH added before transport header, ESP covers TCP header and data. **Tunneling mode:** in which the entire packet is encrypted. End to end packet already attached, one end is a gateway. AH and ESP used to cover everything + end to end New up given to facilitate hop.  **• SSL:** One of the benefits of using SSL is that it uses port 443, already often configured for use on firewalls – Split Tunnel vs. Full Tunnel:  **• Split =** only certain types of traffic are sent  **Full =** all traffic   |
| **VPN Protocol Comparisons**      | -**Point-to-Point Tunneling Protocol (PPTP):** one of the 1st VPN protocols, MSFT .Uses standard auth protocols. Uses TCP port 1723. No longer considered secure.  **- Layer 2 Forwarding (L2F):** Cisco, operates at Data Link layer (Layer 2), does not encrypt.  **- Layer 2 Tunneling Protocol (L2TP):** a merger of PPTP and L2F. Uses IPSec for encryption. Uses TCP port 1701 and UDP port 500. **- Secure Sockets Layer (SSL): see above page’s notes on SSL - Transport Layer Security (TLS): works in a similar way to SSL, uses port 443 or port 30**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |

**5.6 Web Threat Protection**

| Term                          | Definition                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|-------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| **Web threats**               | Any threat that comes from or utilizes the internet. Example: mass emails, bad email links, and websites specifically targeted to exploit security weaknesses.  Connectivity to the internet = eventually compromised by web threats. Companies might implement usually hardware-based devices designed to thwart specific attack types.                                                                                                            |
| **Unified Threat Protection** | A single-purposed device to combat each specific web threat. Often placed in the demilitarized zone, or inside of the internal network's firewall. Policies given to devices that allow or block traffic. Dependent on attack service, budget and size of company-use if budget is lower.                                                                                                                                                           |
| **Web filter**                |  Prevent users from accessing restricted websites using blacklists. Examines requests from clients for internet resources like websites, emails, and file downloads to match deny cases. Can be used to enforce the organization's internet usage policy, helps to **increase bandwidth availability.** **URL, not content based.**  Often paired with content filters.                                                                             |
| **Web threat filter**         | Prevents a user from visiting a website with categories= inappropriate or potentially malicious. Can elect to permit or deny by category. Also protects against pre-determined harmful websites. Kept updated by a subscription service.                                                                                                                                                                                                            |
| **Spam**                      | Irrelevant or inappropriate email sent to a large number of recipients.                                                                                                                                                                                                                                                                                                                                                                             |
| **Spam filter**               | Spam mail solution must act on data coming into the network.  Exists **inside the network's DMZ**.  Incoming mail should be redirected to the gateway spam filter and analyzed, look for **known spammers**, an **abnormally large number of recipients**, or **malicious links** contained within the email message.  Often **paired with** **virus scanners** because spam can contain malware or malicious links. Kept updated with definitions. |
| **Virus scanners**            | Examines attachments &blocks them if they hold damaging components.  Kept updated with definition, usually automatically.  Usually coupled with **spam filters**                                                                                                                                                                                                                                                                                    |
| **Anti-phishing software**    | Detects potential phishing messages & prevents them from reaching user.  Also work on outgoing messages to stop completion/bad redirects.                                                                                                                                                                                                                                                                                                           |
| **Data loss prevention**      | Software that protects sensitive data from exposure                                                                                                                                                                                                                                                                                                                                                                                                 |
| **Encryption**                | Making data unintelligible except to holder of proper decryption key.                                                                                                                                                                                                                                                                                                                                                                               |
| **Proxies**                   | **Transparent proxies** are located between a user and the internet, and they can redirect requests without changing the request. These can be used for web filtering. **Forward proxies** can be used to filter web content, but can also be used to mask a user's identity for anonymity. This can make it difficult for attackers to target users or an organization. **Reverse proxies** can be used for caching and authentication.            |
| **Spear phishing /whaling**   | Malicious emails directed at specific persons and executives.  Look for and warn admin of email containing pwd change.                                                                                                                                                                                                                                                                                                                              |

**Security+ 5.7 Network Access Control Terms:**

| Term                             | Definition                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|----------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| **Network Access Control**       | A policy-driven control process that allows or denies network access to devices connecting to a network.  1 Not a product but a process. **Cisco→Identity Service Engine(ISE)** and **Microsoft→ Network Access Protection (NAP)**  2. Often integrated with **automatic remediation**, bringing a computer wanting access into compliance.   3.Stages: **Authentication(who are you)** and **Authorization(are you allowed)**                                                                                                                                                                                                                                                                                                                              |
| **Bring your own device (BYOD)** | use of personal mobile devices to connect to the organization's network to work                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| **NAC Agents:**                  | **software that helps manage in the Authentication and Authorization process**  **1.1. Permanent:** The agent resides on a device permanently. This is the most convenient agent since it does not have to be renewed and can always run on the device. It is also known as a **persistent agent**.  **2.2. Dissolvable:** The agent is downloaded, or a temporary connection is established. It is removed once the user is done with it. The user has to download or connect to the agent again if needed.  **3.3. Agentless**: The agent is on the domain controller. When the user logs into the domain, it authenticates with the network. Agentless NAC is often used when there is limited disk space, such as for Internet of Things (IoT) devices. |
| **NAC Process:**                 | 1. **Plan** - A committee should convene and make decisions that define how NAC should work. 2. **Define** - The roles, identities, and permissions (policies) must be defined. 3. **Apply** - Once defined, the polices must be applied. **4. Review/Revise** – review process to determine whether changes are required.                                                                                                                                                                                                                                                                                                                                                                                                                                  |

**5.8 Network Threats**

| Term                         | Definition                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| **Network attacks**          | Gain access to a system or systems. Threat actors use systems as a pivot point to access other systems on a network. Attackers use this highway to gain access to vulnerable systems. All data may be intercepted if an attacker acquires access to a network.                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| **Reconnaissance**           | **Active Reconnaissance**. Attempts to gather information about vulnerabilities through automated scanning or manual testing using various tools like ping, traceroute, netcat etc.  Requires that attacker interact with the target.  Faster and more accurate, but increased chances of interception by firewall/Ids/Ips.  **Passive Reconnaissance**:  Look for specific servers with open ports, DNS usage information, network topology, protocols in use, etc.  Primary goal is not to compromise, but learn strengths and weaknesses. May be done slowly or at odd hours                                                                                                                              |
| **Active attack**            | Perpetrators attempt to compromise or affect the operations of a system                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| **Passive attack**           | Perpetrators gather information without affecting the targeted network's flow of information.  May use an organization's website, business filings, other public information, or even dumpster diving to gain information such as employee names, internet registry, financial information, or other pertinent information.                                                                                                                                                                                                                                                                                                                                                                                  |
| **External attack**          | An attack in which unauthorized individuals try to breach a network from outside the network, definitely without authorization. Attempt to compromise the network using reconnaissance info.   Example: Brute-Force with dictionary/rainbow Table vs. passwords, DDOS                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| **man-in-the-middle attack** | Gathers authentication information and then use an ACL attack to gain authenticated access to a secure database. Can be done via ARP poisoning, where the data is intercepted/altered before being sent back to intended sender.                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| **Steps of attack**          | Step 1: passive attack to ID vulnerable device Step 2: Active attack to exploit and infiltrate, create remote access.(e.x. public facing DMZ servers) Step 3: pivot from compromised access point into internal network.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| **Inside attack**            | An attack initiated by authorized individuals inside the network's security perimeter who attempt to access systems or resources to which they're not authorized.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| **Entry point**              | An entry point is a location or device that allows network access and is vulnerable to attacks.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| **Network baseline**         | The network baseline is the normal network activity including typical traffic patterns, data usage, and server loads. Activity that deviates from the baseline can indicate an attack.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| **Network segmentation**     | Division of a network into smaller networks or pieces for performance or security reasons.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| **Network mapping**          | **Create a physical and logic network diagram**. This diagram should include as much information as reasonably possible to define the network and show how information flows from endpoint to server to internet and back.  **Document all assets** such as server, communications equipment, security devices and endpoints. **Define potential points of entry**.  **Defining the network baseline**. Know what is normal. **ID potential vulnerabilities**. Using white hat tools to find and eliminate vulnerabilities in network devices take steps to patch and secure all devices on the network reduce the attack surface of the organization.                                                       |
| **Secure Network Design**    | **Separation or segmentation of devices**. Creating network segments can help avoid potential overlaps and separate data with virtual LANS, or **VLANS**.  **Separate less secure devices from the more secure devices**. **VLAN 10** for less secure/IOTs. **VLAN 30 forces a separation of critical devices needing additional security. Enhance VLAN segmentation and security with IPS/IDS or firewalls.** **Limit damage to network;** network traffic is broken into manageable chunks. **Segment wireless from wired, and workstations from servers.** no-trust zone: No control, aka internet low-trust zone: Publically available info/DMZ medium-trust zone: high-trust zone: highest-trust zone:  |

**5.9 Network Device Vulnerabilities**

| Term                                             | Definition                                                                                                                                                                                                                                                                                            |
|--------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| **Privilege escalation**                         | A software bug or design flaw in an application that allows an attacker to gain access to system resources or additional privileges that aren't typically available.                                                                                                                                  |
| **Backdoor**                                     | An unprotected and usually lesser known access method or pathway that may allow attackers access to system resources.                                                                                                                                                                                 |
| **Zero-day vulnerability**                       | A software vulnerability that is unknown to the vendor that can be exploited by attackers. Keep updated and patched. NIST: has a database for known vulnerabilities.  CVSS: open framework for communicating characteristics and severity of software vulnerabilities. Scale of 0-10 CVE identifiers. |
| **Common Vulnerabilities  and Exposures (CVEs)** | A repository of vulnerabilities hosted by MITRE Corporation.                                                                                                                                                                                                                                          |
| **Physical Access**                              | Evil USBs, change passwords, add credentials Enforce authorization, physical security and alarms.                                                                                                                                                                                                     |
| **Credential management**                        | If any device becomes comprised, the attacker then has access to all device configurations. Discretionary credentials: least privileges                                                                                                                                                               |
| **Updating**                                     | Firmware with protocol updates for secure encryption                                                                                                                                                                                                                                                  |
| **Weak security:**                               | Use of outdated encryption(sha1 and wep), try to update with 3des, sha256 and aes Default credentials                                                                                                                                                                                                 |
| **Device misconfiguration**                      | Misconfigured firewalls, spam and virus scanners Wireless access points with weak encryption.                                                                                                                                                                                                         |

**5.9.2 Device Vulnerability Facts**

| Vulnerability                      | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| **Default accounts and passwords** | Default account names and passwords should be changed immediately when hardware or software is turned on for the first time.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| **Weak passwords**                 | Passwords that are blank, too short, dictionary words, or simple. In other words, quickly identified using password cracking tools.  **Password cracking:** process of recovering secret passwords from data that has been stored in, or transmitted by, a computer system.  **Enforce complex passwords**  -require passwords of a certain length (typically over 8 characters)  -a mix of character types (numbers and symbols)  -not words, variations of words, or derivatives of the username.                                                                                                                                                                                                                                                                                                                                                                                 |
| **Privilege escalation**           | Allows a user to take advantage of a software bug or design flaw in an application to gain access to system resources or additional privileges that aren't typically available to that user.  A user accessing a system with a regular user account that is able to access functions reserved for higher-level user accounts (such as administrative features). A user who is able to access content that should only be accessible to a different user. A user who should only have administrative access that can access content that should only be available to a regular user. **Privilege escalation does not occur when a user is able to steal or hack administrator credentials and is therefore able to access administrative functions.** Privilege escalation refers to **accessing features with an account that normally should not have access to those features.**  |
| **Backdoors**                      | Unprotected access method or pathway.  Include hard-coded passwords and hidden service accounts Often added during development as a shortcut to circumvent security.  Can be added by attackers who have gained unauthorized access to a device and used to bypass security controls. Can be used to remotely control the device  Rely on secrecy to maintain security **Do not allow programmers to bypass security during development.**  **Carefully examine the code before release** to remove any traces of backdoors.                                                                                                                                                                                                                                                                                                                                                        |
| **Unauthorized SSH**               | Access to root through SSH.  Example: Use of NMap to sweep for hosts, detect for port 22 access, use script below: 'nmap - -script=ssh-brute [IP]’                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |

**5.10.3 Network Application Facts**

| Software                        | Considerations                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|---------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| **Peer-to-peer (P2P)/torrent**  | Software that allows users to share content without centralized servers or centralized access control. create a mesh network of computers to distribute the bandwidth  May contain malware, viruses, and illegal content.  Download and upload bandwidth hungry.  Data loss may occur from computer being turned into download stations. **Instead of blocking ports** which can be changed by users, **block p2p packets and /or installation of clients.** Also used to push windows OS updates Use content filters to block downloading and uploading copyrighted files  Block the port the P2P software is using. Enable encryption in the P2P program.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| **Instant messaging (IM)**      | Real-time text messaging communication, supports picture, music, and document exchange. Use of peer-to-peer networking makes IM clients less secure than other communication methods. IM is either in cleartext or uses an easily broken basic encryption scheme to **protect integrity rather than confidentiality**. IM traffic is subject to sniffing, capturing, and viewing by others. Loss of productivity  Malicious code propagation, worms, and viruses are easily spread through IM, spim(IM spam) Contain user directories, making it easy to identify spim targets; contains demographic information about users. Information in contact lists can be remotely accessed. **Create a whitelist or use an IM blocker** as a countermeasure to spim.  **Client-side scripting** allows attackers to send messages on behalf of other IM users and can be used for social engineering. IM clients often indicate when you are online, even without your consent. May track your use for marketing purposes. IM platforms can be a vehicle for malware and virus delivery, social engineering or simple disclosures.  **Difficult to block completely due to encrypted packets.**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| **Control Networking software** | Written policy that identifies the allowed or prohibited usage of all software. Group Policy to prevent installation of the software. Block firewall ports that are used by the prohibited software. A firewall alone may be insufficient: circumvent firewall ACLs by reconfiguring network applications to use ports commonly left open. **Packet filtering firewalls do not inspect the contents of a packet**. Only the source IP address, destination IP address, protocol, and port are used to determine if a packet should be blocked. An application control solution can be used to block unauthorized network applications.  Application control implementations **use application signatures** to identify specific applications through inspecting packet contents. Application whitelist defined centrally and applied to all network devices.  Only applications contained in the whitelist are allowed. Several actions can be applied to applications that not whitelisted:  **Flagged** applications are allowed but a violation is logged when they are identified. **Blocked** applications are not allowed and are blocked. The session is **dropped if it uses UDP and reset if it uses TCP.** **Tarpitted** applications are not allowed. However, the connection between hosts is kept alive while the application data itself is silently dropped. This makes it appear to both hosts that the other host is receiving the data but not responding. Only some ACLs have this function. Not all application control solutions support tarpitting application traffic.  If a user tries to use a disallowed application, will be prompted to contact the help desk or system administrator for review and approval. |

**5.11 Switch Security and Attacks**

| Term                                                    | Definition                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|---------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| **Dynamic Host Configuration protocol (DHCP) snooping** | A security feature on some switches that filters out untrusted DHCP messages.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| **Dynamic ARP  Inspection (DAI)**                       | A security feature on some switches that verifies each ARP request has a valid IP to MAC binding.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| **MAC flooding**                                        | An attack that overloads a switch's MAC forwarding table to make the switch function like a hub. Switches maintain MAC address tables, aka CAM tables, to track workstations' and ports' associations. Switches learn which workstation is connected to each port, stored in the MAC address table and used when switches forward information.  Attackers can flood the switch with fake MAC address information to fill the MAC address table. Switch eventually enters a **fail-open mode** and **behaves the same as a network hub or Layer 1 device**, broadcasting widely.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| **ARP spoofing/poisoning**                              | AKA ARP poisoning. An attacker’s MAC address is associated with the IP address of a target's device. Attacker sends commands to the switch to overwrite the contents of its ARP table. Data intended for the legitimate device is now sent to the attacker's device.  Attacker captures the data and sends it on to its rightful owner. This is known as a **man-in-middle attack**. ARP is similar to DNS. Which resolves a fully qualified domain name into an IP address. **ARP associates a device's MAC address with the IP address assigned to that same device.**  **A switch creates and stores an ARP table in memory for easy lookup.**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| **VLAN hopping**                                        | An attack in which the source MAC address in changed on frames sent by the attacker.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| **VLAN spoofing(hop subtype)**                          | Switches enable dynamic trunk negotiation by default, known as dynamic auto or dynamic desirable.  A switch connected to the original switch has their connecting ports configured as a trunk connection.  Attacker tricks switch into thinking their connection is trunk type. This can be done even with just one switch.  Imagine: one switch with 2 VLANs: 10 and 20. 20 holds the goods. Insider uses a DTP frame with tool **Yersinia** to disguise connection as a trunk, allowing bypass of VLAN segregation and packet capturing.  Disable all auto-negotiation except to authorized switches.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| **double tagging(hop subtype)**                         | When the attacker's computer is on one VLAN switch, and the target computer is on a VLAN attached to a separate switch && the switches configured to use what's called native VLANs.  Packets sent to a switch have a VLAN tag, indicating which switch should process the frame. For example, you'll notice that both users are on VLAN 10. If User A wants to send data to User B, the frame would include the VLAN tag indicating that the frame was intended for VLAN 10. When the data reaches the switch, the VLAN tag is removed and the packet is sent to its rightful destination.  Manipulate the frame being sent to include two VLAN tags. One for VLAN 10 and one for VLAN 20. When this type of frame is received by VLAN 10's switch, the first VLAN tag is removed. The frame is then forwarded to that switch for VLAN 20. Make sure that your switches aren't configured to use native VLANs. Trunk ports configured with a native VLAN won't apply their own VLAN tag when sending these frames, which lets the attacker's tagged frames to continue                                                                                                                                                                                 |
| **MAC spoofing**                                        | Source MAC address is changed in the header of a frame. Sending out data from a computer using a MAC address that's different from the MAC address physically hard-coded on a network interface card, or NIC. Tools like Windows Network and Sharing Center in Control Panel, SMAC for Windows, and others that can make an operating system believe that the NIC has a different MAC address for **defeating port security**. Some networks, have whitelisted MAC addresses as part of switch's security. **Find good MAC, spoof good MAC, and win.** Attacker can change their MAC address to mimic a targeted system and send the switch a MAC update command, changing the MAC address table to send data meant for victim to their system. Since it's controlled on the attacker's computer, there is **no way to prevent MAC spoofing, except using techniques at the Application level of the OSI model.**                                                                                                                                                                                                                                                                                                                                       |
| **Dynamic Trucking  Protocol (DTP)**                    | An unsecure protocol that could allow unauthorized devices to modify a switch's configuration.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| **STP manipulation(spanning tree protocol)**            | Become dispatch, see everything.  STP is normally configured on a network with several switches to prevent switching loops by dynamically turning off certain switch ports to ensure that data can't get stuck hopping from switch to switch   A single switch is designated as the **root bridge**, which is an optimized data path's primary source, leading a “network” of switches providing redundancy.  The root bridge passes data between switches as a central depot, and calculates the spanning tree from topology changes advertised by non-root bridges. When an attacker becomes the root bridge, they are able to see many frames.  Attack done by sending bridge ID frames, or **BID frames**, with a lower ID than legitimate bridge’s.  **Make sure that attackers can't easily guess which bridge ID number is being used: ensure that your bridge ID is much lower than the default.** If possible, **set up Bridge Protocol Data Units Guard**, or BPDU Guard, allowing an interface to block itself when it receives a BPDU packet to change root bridge switch. **Enable Root Guard** on the ports not being used as trunk lines. If one of these ports receives a BPDU frame, a sys error is logged and that port is blocked.   |

**5.11.3 Switch Security Facts**

| Feature                          | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|----------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| **Virtual LAN (VLAN)**           | A logical grouping of computers based on switch ports.  A grouping of devices based on service need, protocol, or other criteria, rather than physical proximity. Membership done by assigning a switch port to a VLAN. A switch can have multiple VLANs, but each switch port can **usually** only be a member of a single VLAN  Single switch or multiple interconnected switches. With **multiple switches, each switch can be configured with the same VLANs, and devices on one switch can communicate with devices on other switches as long as they are members of the same VLAN.** VLANs are commonly used with voice over IP (IP (VoIP) to distinguish voice traffic from data traffic. Traffic on the voice VLAN can be given a higher priority. A **trunk port** is used to connect two switches together, usually WITH gigabit. Member of all VLANs defined on a switch, carries traffic between the switches. frames sent over trunk ports tagged by the first switch with the VLAN ID for receiving switch  **Switches use Trucking Protocol** use for frame tagging with the VLAN ID. Switch removes VLAN tags before forwarding to destination device. VLAN tagging is only used for frames that travel between switches on the trunk ports. Switch can be used to create multiple IP broadcast domains, each with their own VLAN. Broadcast traffic hoes only to members of the same VLAN. With multiple VLANS, one cannot usually talk to another. To enable inter-VLAN communication, you need to use a router (or an OSI Layer 3 switch).                                                                                                                                                                                              |
| **MAC filtering/port security**  | **Port security** uses the MAC address to identify allowed and denied devices. **MAC addresses are stored in RAM in a table**, associated with the port. The table can be manually configured, or learning devices can automatically build the table. Only a single MAC address is allowed per port, **or** each port can have multiple addresses. Automatic configuration: the next device or specified number of devices can connect to the port and additional devices are denied. **Port violation**: when an unauthorized device tries to connect. The switch configuration may either drop all frames from the unauthorized device or shut down the port.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| **Port authentication (802.1x)** | Allows authenticated devices to connect to the LAN through the switch. Authentication uses user names and passwords, smart cards, or other authentication methods.  When a device first connects, the port is set to an unauthorized state. Ports in unauthorized states can be used only for 802.1x authentication traffic. Switch begins by sending an authentication request to the device. **The device responds with authentication credentials**, forwarded by the switch to the authentication device (such as a **RADIUS server**). After the server authenticates the device or the user, **the switch port is placed in an authorized state** On disconnect, the switch places the port in the **unauthorized state**.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| **Switch Security**              | Create virtual LANs based on criteria such as workgroup, protocol, or service Simplify device moves (devices are moved to new VLANs by modifying the port assignment) Control broadcast traffic based on logical criteria (only devices in the same VLAN receive broadcast traffic) Control security (isolate traffic within a VLAN)  When you use switches to create VLANs, you still need routers to: Route data between VLANs Provide port filtering to filter network packets in and out of devices based on their application type or port number. Route data into and out of the local area network MAC filtering Disable ports not in use(all ports open by default)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| **Spanning Tree Protocol**       | Many networks implement redundant paths between devices with multiple switches for fault tolerance. Switching loops, causes packets/unicast traffic to travel endlessly, leading to incorrect entries in a MAC address table, making a device appear to be connected to the wrong port Spanning Tree Protocol prevents switching loops by making only one single path between switches active at a time.  Provides redundant paths between devices Recovers automatically from a topology change or device failure by unblocking redundant paths Identifies the optimal path between any two network devices Assign role to each bridge or switch and their ports for optimal paths. The type of ports used by the Spanning Tree Protocol are: Root ports, configured to communicate directly to the root switch. Designated ports, which forward frames to and from attached hosts. Blocked ports, which form a loop and are used for redundancy. Ports in the Spanning Tree Protocol exist in one of five states: Blocking Listening Learning Forwarding Disabled                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| **Switch hardening**             | Port security, management access, and access control using access control lists, ACLs.  Configure Port Settings 0:27-2:06 Shut down any unused ports. Set the Administrative Status as Down.  Copy Settings.  Those ports will come up at a down state each time the switch starts up. Save our Configuration File to the Startup Configuration.   Enable port security.   Lock the port, allow only certain MAC addresses to pass traffic through this port. A Classic Lock means that the first device you connect to that port will be the only one allowed to pass traffic through this port.   Limited Dynamic Lock, controlling how many concurrent device connections/pass traffic.  Discard Forward Shutdown Lock- Trap MAC addressed.  management access Rule One that we want to have will deny all management. Deny and specify all different management methods. (Do not complete, will lock out.) For Rule Number Two, allow HTTP access. Select all interfaces, but also allow traffic from a specific workstation or IP address. 192.168.1.200 will be the only workstation allowed to access this port. Input the network mask by typing 255.255.255.0. Alternatively, can use the prefix length and use the prefix  This denies all types of management interfaces with this switch, except for the HTTP access from the one workstation that we have selected.   Update and apply firmware  Access Control using ACLs  MAC based ACL IPV4 based ACL IPV6 based ACL.  Enter 00041F followed by six ones. Under Source MAC Wildcard Mask we'll enter six zeroes followed by six ones.  This says that we only care about the first six digits of the MAC Address, preventing any device from the same manufacturer from being connected.   |

**5.11.7 Switch Attack Facts**

| Attack                               | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|--------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| **MAC flooding**                     | Overloads the switch's MAC forwarding table to make the switch function like a hub.  Floods switch with packets, each containing a different source MAC address. Fills up the forwarding table, consume memory and causes the switch to enter a state called *fail open mode*. In fail open mode, all incoming packets are broadcast out to all ports (as with a hub), instead of to the designated port (as a switch normally does). The attacker then captures all the traffic with a protocol analyzer/sniffer.                                                                                                                                                                                                                                                                                                                     |
| **ARP spoofing/poisoning**           | Associates the attacker's MAC address with the IP address of victim's device.  When computers send an ARP request for the MAC address of a known IP address, the attacker's system responds with its MAC address. The source device sends frames to the attacker's MAC address instead of the correct device. Switches are indirectly involved in the attack because they do not verify the MAC address/IP address association. A default gateway is a prime target because local traffic goes through a default gateway to get to non-local destinations such as the internet. When the attacker's system MAC address receives packets intended for the default gateway, the attacker can: Forward the packets to the actual default gateway (passive sniffing). Modify data in the packets before forwarding it (man-in-the-middle). |
| **MAC spoofing**                     | Changing the source MAC address on frames. The attacker's system sends frames with the spoofed MAC address. The switch reads the source address contained in the frames and associates the MAC address with the port where the attacker is connected. MAC spoofing can be used to:  Bypass 802.1x port-based security. Bypass wireless MAC filtering. Hide the identity of the attacker's computer or to impersonate another device on the network. Impersonate a device on the network to capture frames addressed to that device. Impersonate a valid device on the network to gain network access. For example, to gain access when the switch is using the MAC address to allow or deny a network connection.                                                                                                                      |
| **Dynamic Trucking Protocol  (DTP)** | Switches have the ability to automatically detect trunk ports and negotiate the trucking protocol used between devices. The Dynamic Trucking Protocol is not secure and allows unauthorized devices to possibly modify configuration information. Disable the DTP services on the switch's end user (access) ports before implementing the switch configuration into the network.                                                                                                                                                                                                                                                                                                                                                                                                                                                      |

**5.12 Using VLANs**

| Term                   | Definition                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| **Virtual LAN (VLAN)** | Segment the network into smaller broadcast domains, which reduces the number of broadcast messages that network devices receive. In other words, VLANs don't pass broadcast traffic to nodes that aren't part of their network. Reducing broadcast traffic has a direct effect on network performance.  Physical infrastructure flexibility and security With VLANs, you can create separate logical networks for each department so only personnel in a certain department can access those resources.  Since VLANs are configured with software, it's easy to reassign ports when personnel change locations or new ports are added to the VLAN.  Increased flexibility because ports are easily reconfigured as needs change within the organization, and the costs associated with those changes are minimal.  Useful when you're grouping devices that need to coordinate with each other, but are inherently insecure.  In many industrial applications, systems are comprised of programmable logic controllers, sensors, or remote terminal units that are controlled by a supervisory system. These end devices often lack proper security controls, making it imperative that network traffic is isolated to only authorized devices.  Often used to isolate devices with weak security controls, as is common with Internet of Things devices. Prevents pivoting. ![Single-switch VLAN](media/335ed400629ab82fd67c026507821647.jpeg) In this example: Fast Ethernet ports (fax) 0/1 and 0/2 are members of VLAN 1. Fast Ethernet ports (fax) 0/3 and 0/4 are members of VLAN 2. Workstations in VLAN 1 are not able to communicate with workstations in VLAN 2, even though they are connected to the same physical switch. There are two broadcast domains, each of which corresponds to one of the VLANs. Defining VLANs creates additional and separate broadcast domains. VLAN Defaults Default VLANs. For example most Cisco switches have the following default VLANs:  VLAN 1 is the default VLAN. You can use this VLAN but you cannot delete it. VLAN 1002 - VLAN 1005 reserved for backward compatibility with old/unused VLAN implementations. You cannot use or delete these VLANs. By default, all ports are members of VLAN 1. 1 - 1005 is the normal range for VLANs. 1006 - 4094 is the extended range for VLANs. VLAN Advantages and Disadvantages Can create virtual LANs based on criteria other than physical location Simplify device moves to new VLANs by modifying the port assignment. Control broadcast traffic, create collision domains based on logical criteria. Can control security (isolating traffic within a VLAN). Load-balance network traffic logically vs. physically. Easier to administer than routers. Less expensive than routers. Offer higher performance because they introduce less latency. **Might be tied to a specific vendor’s switches and their VLAN creation methods. 802.1Q may circumvent this.**  Despite advances in switch technology, routers are still typically used to: Filter WAN traffic. Route traffic between separate networks. Route packets between VLANs, though Layer 3 switches can also do this. VLANs and Voice over IP Switch port voice van [number] command. By default, IP phone traffic on a voice VLAN is tagged with an 802.1Q priority of 5. When an interface is configured with a voice VLAN, the Port Fast feature is automatically enabled on the interface. A Cisco IP phone automatically uses the VLAN ID of the port it is connected to. Non-Cisco IP phones require the VLAN ID to be manually configured on the IP phone. |

**5.13 Router Security**

| Term                          | Definition                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|-------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| **Router**                    | A network device that transmits data from one network to another.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| **Access control list (ACL)** | Router filter that controls which network packets are permitted (forwarded) or denied (dropped) in or out of a network. **The routing table is used to determine where network packets are forwarded to. ACL, is used to determine whether or not a packet is allowed to be forwarded. (address vs. stamp)** ACL on a router could be set to ban all incoming traffic destined to a specific IP address inside the network ACLs almost always includes a hidden deny any statement at the end of the list.  Must add at least one permit statement that either permits a specific traffic type or permits all traffic not specifically restricted to permit any traffic. Standard ACLs filter traffic based on the source host name or host IP address  Extended ACLs filter traffic based on port number, destination host name, IP protocols or host IP address. Place these as close to the source as possible.  |

**5.13.3 Router Security Facts**

| Security Measure                         | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| **Change factory defaults**              | Change the default manufacturer's username and password, encrypt the new password. Use a complex passwords over eight characters; contain a mix of character types (numbers and symbols); and are not words, variations of words, or derivatives of the username. Change the default network address. Some routers default to 192.168.1.1 or 10.0.0.1.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| **Use secure protocols**                 | SSH uses RSA public key cryptography for both connection and authentication and provide security services for other protocols. Secure Copy Protocol (SCP) is a secure file copy protocol that uses SSH for security. HTTP (Hypertext Transfer Protocol) over SSL (Secure Sockets Layer), known as (HTTPS), is a secure form of HTTP that uses SSL to encrypt data before it is transmitted. Do not use HTTP, Telnet, File Transfer Protocol (FTP), or Trivial FTP (TFTP). [cleartext] Safest: Connect the management station to the router's console port  Avoid using UPnP (Universal Plug and Play, opens ports in network remotely, easily exploited) Change the default username and password on a router connecting to network or internet.  Change default network address away from 192.168.1.1, aka security through obscurity  If SOHO router, change default SSID and wireless encryption. Update Firmware. Make sure transmission protocols are secure.                                                                                                                                                                 |
| **Physical Security**                    | Keep network devices in a locked room.  Use: Perimeter barriers Closed-circuit television (CCTV) Doors Door locks Physical access logs Physical access controls Backup, encrypt router configuration files, backup files, and encrypt backups.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| **Remote Access Regulation**             | Restrict internal network remote access, and disable external remote access until needed.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| **Use anti-spoofing rules**              | Counter attacks where IP packets have a source address that does not belong to the sender.  Anti-spoofing rules analyze the IP packet and match the router interface and direction from which the packet is received. An inbound packet that comes to the external interface must not have a source address that match the internal network or the router itself.  A typical anti-spoofing rule: Source: An IP address belonging to the internal network or the IP address of the router itself Destination: Any Service: Any Interface: Any external interface Direction: Inbound Action: Deny Time: Any                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| **Access control lists  (ACLs) example** | Lists should go from the most specific conditions to the most general.  Create a statement added to our access list that denied FTP, then later allow all other application protocols that sit on top of the IP protocol.  Implicit deny anything else or any other traffic at the end of every access control list.  Find IP address in command prompt by typing IPconfig. Create an access list, and call it access list 10. Standard lists range typically from 1 to 99, or from 1300 to 1999.  State deny 10.0.0.2, and specifically just that host (Google). Wild card mask. Anything that's a zero there, says it has to match, or the IP address has to match that.  Go to FA0/1, and apply this access list to that. Implicit deny now blocks access to internet.  No IP access group 10 in, reverses the command. Deny ICMP, and a single host with, "Host."  “Deny this specific host for ICMP." "To anything that comes through."  0.0.0 Says, "Anything." Coupled with this wildcard mask then that denies all ICMP.  Permit IP for that host. "To any,"  Apply that to FA0/1. Not able to ping, but internet capable. |
